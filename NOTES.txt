# GENERATE ENV FILE DA METTERE IN COMANDO pipe

def file_gfu_env = new File("${bpipe_config_home}/templates/gfu_environment.sh.template")

def binding_gfu_env = [
    "project_name"             : project_name
]
def template_gfu_env = engine.createTemplate(file_gfu_env.text).make(binding_gfu_env)

def write_gfu_environment = { file ->
    file.write(template_gfu_env.toString())
}

// ENVIRONMENT FILE
def env_file = new File("${dir_path}/gfu_environment.sh")
if ( env_file.exists() ) {
    if (force) {
        println red("File $env_file already exists. Overwriting ...")
        write_gfu_environment(env_file)
    } else {
        println red("File $env_file already exists. Skipping ...")
    }
} else {
    write_gfu_environment(env_file)
    println green("Created file: $env_file")
}

def env_file = new File("gfu_environment.sh")
if ( env_file.exists() ) {
    if (force) {
        println red("File $env_file already exists. Overwriting ...")
        write_gfu_environment(env_file)
    } else {
        println red("File $env_file already exists. Skipping ...")
    }
} else {
    write_gfu_environment(env_file)
    println green("Created file: $env_file")
}